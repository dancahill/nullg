#!/usr/bin/nesla
if (typeof(expect)!='function') include("_expect.ns");
function testzlink() {
	local function f1() {
		return 41;
	}
	local function f2() {
		return 42;
	}
	local a={ a=1, b=2, f=f1 };
	local b={};

	zlink(b, a);
	expect("a['a']", 1,      a['a']);
	expect("b['a']", 1,      b['a']);
	a['c']=3;
	expect("a['c']", 3,      a['c']);
	expect("b['c']", 3,      b['c']);
	b['d']=10;
	expect("a['d']", 'null', tostring(a['d']));
	expect("b['d']", 10,     b['d']);
	b['f']=f2;
	expect("a.f()",  41,     a.f());
	expect("b.f()",  42,     b.f());
	b={};
	expect("b['c']", 'null', tostring(b['c']));
	zlink(b, a);
	expect("b['c']", 3,      b['c']);
	return;
}
testzlink();
global testzlink=null;
